# 文本管理使用指南

用 CloudPaste 创建、分享、保护你的文本（含 Markdown）。


## 1. 可以做什么
- **创建文本分享**：支持标题、备注、内容（Markdown 也行）。
- **安全选项**：可选密码、到期时间、最大查看次数、是否公开。
- **访问方式**：普通查看页 `/paste/:slug`，原始文本 `/api/raw/:slug`。
- **管理**：管理员可全量查看/搜索/删除/清理过期；API Key 只能管理自己创建的分享。


## 2. 创建一步到位
1) 打开前台首页（Markdown 编辑器）或后台“文本管理”。  
2) 填写：  
   - 标题（可空，默认用短链接 slug）  
   - 文本内容（必填，支持 Markdown）  
   - 备注（可空）  
3) 可选开关：  
   - **密码**：访问前需验证；返回的代理链接会带上密码参数，方便直接分享。  
   - **到期时间**：时间到了自动失效并清理。  
   - **最大查看次数**：看够次数即删除。  
   - **公开/非公开**：非公开时，只有管理员或创建者（apikey:ID）可访问。  
4) 提交后获取短链接 slug（可自定义，需唯一且仅含字母数字/`-`/`_`/`.`）。


## 3. 如何访问
- **常规查看页**：`/paste/{slug}`，支持密码验证、剩余次数提示。  
- **原始文本**：`/api/raw/{slug}`；若有密码需带 `?password=xxx`。  
- **最后一次查看**：到达最大查看次数时会提示并删除。  
- **过期处理**：到期立即删除并返回“已过期/已删除”。


## 4. 管理与清理
- **管理员**：可搜索/筛选创建者、批量删除、清理过期（`/api/pastes/clear-expired`）。  
- **API Key 用户**：只看见自己建的文本；只能删除/更新自己的分享。  
- **批量删除**：支持一次删除多条，失败项会逐条返回原因。  
- **修改**：可更新标题、备注、密码、到期、最大次数、是否公开。
- **视图切换（瀑布流）**：后台“文本管理”支持列表/瀑布流切换，瀑布流适合浏览大量文本卡片，列数与间距可在工具栏调节并本地记忆,桌面端双击卡片进入编辑；移动端长按 0.8s 进入编辑；编辑时 `Ctrl+Enter` / `⌘+Enter` 保存，`Esc` 取消。


## 5. 权限与安全要点
- 管理员：全权管理，不受路径密码等限制。  
- API Key：必须拥有文本权限位（TEXT_SHARE / TEXT_MANAGE），且只能操作自身创建的数据。  
- 公开/非公开：非公开会对未登录或无匹配身份的访问者返回“未找到”。  
- 密码验证：错误或缺失密码会直接拒绝；密码变更会使旧 token 失效，需要重新输入。


## 6. 常见场景
- **一次性分享**：设置最大查看次数=1，或短期过期时间。  
- **机密片段**：设密码 + 非公开；仅管理员/创建者可见。  
- **公共示例**：设为公开，无密码，便于嵌入示例链接。  
- **清理旧数据**：后台“清理过期”一键删除已过期分享。


## 7. 故障排查
- 提示 slug 占用：换一个后缀，或让系统自动生成。  
- 总是弹密码：检查是否开启了密码或父级（非公开）限制；确认密码是否已被修改。  
- 访问显示已删除/过期：查看是否达到最大次数或到期时间。  
- 看不到他人文本：API Key 只能访问自己创建的分享，这是设计限制。

---

**填内容、设好密码/到期/次数，生成 slug 分享；管理员全量管，API Key 只管自己的。**
